# upupa_utils.py
import re

def normalize_upupa_command(text: str) -> str:
    """
    Нормализует команды, начинающиеся с "упупа", убирая знаки препинания после него.
    
    Args:
        text: Исходный текст сообщения
        
    Returns:
        Текст с нормализованной командой "упупа"
    """
    if not text:
        return ""
    
    # Приводим к нижнему регистру для проверки
    text_lower = text.lower()
    
    # Проверяем, начинается ли с "упупа"
    if not text_lower.startswith("упупа"):
        return text.lower()
    
    # Удаляем "упупа" и всё до первой буквы/цифры после него
    after_upupa = text[5:]  # Пропускаем "упупа"
    
    # Удаляем знаки препинания и пробелы после "упупа"
    cleaned = re.sub(r'^[^\w\s]+\s*', ' ', after_upupa)
    
    # Собираем обратно
    result = "упупа" + cleaned
    
    return result.lower().strip()


# Примеры использования:
# "упупа, погода" -> "упупа погода"
# "упупа!!! скажи привет" -> "упупа скажи привет"
# "Упупа,, умоляю" -> "упупа умоляю"
